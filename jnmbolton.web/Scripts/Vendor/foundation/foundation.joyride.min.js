(function(n,t,i,r){"use strict";Foundation.libs.joyride={name:"joyride",version:"4.1.2",defaults:{expose:!1,modal:!1,tipLocation:"bottom",nubPosition:"auto",scrollSpeed:300,timer:0,startTimerOnClick:!0,startOffset:0,nextButton:!0,tipAnimation:"fade",pauseAfter:[],exposed:[],tipAnimationFadeSpeed:300,cookieMonster:!1,cookieName:"joyride",cookieDomain:!1,cookieExpires:365,tipContainer:"body",postRideCallback:function(){},postStepCallback:function(){},preStepCallback:function(){},preRideCallback:function(){},postExposeCallback:function(){},template:{link:'<a href="#close" class="joyride-close-tip">&times;<\/a>',timer:'<div class="joyride-timer-indicator-wrap"><span class="joyride-timer-indicator"><\/span><\/div>',tip:'<div class="joyride-tip-guide"><span class="joyride-nub"><\/span><\/div>',wrapper:'<div class="joyride-content-wrapper"><\/div>',button:'<a href="#" class="small button joyride-next-tip"><\/a>',modal:'<div class="joyride-modal-bg"><\/div>',expose:'<div class="joyride-expose-wrapper"><\/div>',exposeCover:'<div class="joyride-expose-cover"><\/div>'}},settings:{},init:function(t,i,r){return this.scope=t||this.scope,Foundation.inherit(this,"throttle data_options scrollTo scrollLeft delay"),typeof i=="object"?n.extend(!0,this.settings,this.defaults,i):n.extend(!0,this.settings,this.defaults,r),typeof i!="string"?(this.settings.init||this.events(),this.settings.init):this[i].call(this,r)},events:function(){var i=this;n(this.scope).on("click.joyride",".joyride-next-tip, .joyride-modal-bg",function(n){n.preventDefault(),this.settings.$li.next().length<1?this.end():this.settings.timer>0?(clearTimeout(this.settings.automate),this.hide(),this.show(),this.startTimer()):(this.hide(),this.show())}.bind(this)).on("click.joyride",".joyride-close-tip",function(n){n.preventDefault(),this.end()}.bind(this));n(t).on("resize.fndtn.joyride",i.throttle(function(){if(n("[data-joyride]").length>0&&i.settings.$next_tip){if(i.settings.exposed.length>0){var t=n(i.settings.exposed);t.each(function(){var t=n(this);i.un_expose(t),i.expose(t)})}i.is_phone()?i.pos_phone():i.pos_default(!1,!0)}},100));this.settings.init=!0},start:function(){var t=this,r=n(this.scope).find("[data-joyride]"),i=["timer","scrollSpeed","startOffset","tipAnimationFadeSpeed","cookieExpires"],u=i.length;this.settings.init||this.init(),this.settings.$content_el=r,this.settings.$body=n(this.settings.tipContainer),this.settings.body_offset=n(this.settings.tipContainer).position(),this.settings.$tip_content=this.settings.$content_el.find("> li"),this.settings.paused=!1,this.settings.attempts=0,this.settings.tipLocationPatterns={top:["bottom"],bottom:[],left:["right","top","bottom"],right:["left","top","bottom"]},typeof n.cookie!="function"&&(this.settings.cookieMonster=!1),(!this.settings.cookieMonster||this.settings.cookieMonster&&n.cookie(this.settings.cookieName)===null)&&(this.settings.$tip_content.each(function(r){var e=n(this),f;for(n.extend(!0,t.settings,t.data_options(e)),f=u-1;f>=0;f--)t.settings[i[f]]=parseInt(t.settings[i[f]],10);t.create({$li:e,index:r})}),!this.settings.startTimerOnClick&&this.settings.timer>0?(this.show("init"),this.startTimer()):this.show("init"))},resume:function(){this.set_li(),this.show()},tip_template:function(t){var i,r;return t.tip_class=t.tip_class||"",i=n(this.settings.template.tip).addClass(t.tip_class),r=n.trim(n(t.li).html())+this.button_text(t.button_text)+this.settings.template.link+this.timer_instance(t.index),i.append(n(this.settings.template.wrapper)),i.first().attr("data-index",t.index),n(".joyride-content-wrapper",i).append(r),i[0]},timer_instance:function(t){return t===0&&this.settings.startTimerOnClick&&this.settings.timer>0||this.settings.timer===0?"":this.outerHTML(n(this.settings.template.timer)[0])},button_text:function(t){return this.settings.nextButton?(t=n.trim(t)||"Next",t=this.outerHTML(n(this.settings.template.button).append(t)[0])):t="",t},create:function(t){var i=t.$li.attr("data-button")||t.$li.attr("data-text"),r=t.$li.attr("class"),u=n(this.tip_template({tip_class:r,index:t.index,button_text:i,li:t.$li}));n(this.settings.tipContainer).append(u)},show:function(t){var i=null;this.settings.$li===r||n.inArray(this.settings.$li.index(),this.settings.pauseAfter)===-1?(this.settings.paused?this.settings.paused=!1:this.set_li(t),this.settings.attempts=0,this.settings.$li.length&&this.settings.$target.length>0?(t&&(this.settings.preRideCallback(this.settings.$li.index(),this.settings.$next_tip),this.settings.modal&&this.show_modal()),this.settings.preStepCallback(this.settings.$li.index(),this.settings.$next_tip),this.settings.modal&&this.settings.expose&&this.expose(),this.settings.tipSettings=n.extend(this.settings,this.data_options(this.settings.$li)),this.settings.timer=parseInt(this.settings.timer,10),this.settings.tipSettings.tipLocationPattern=this.settings.tipLocationPatterns[this.settings.tipSettings.tipLocation],/body/i.test(this.settings.$target.selector)||this.scroll_to(),this.is_phone()?this.pos_phone(!0):this.pos_default(!0),i=this.settings.$next_tip.find(".joyride-timer-indicator"),/pop/i.test(this.settings.tipAnimation)?(i.width(0),this.settings.timer>0?(this.settings.$next_tip.show(),this.delay(function(){i.animate({width:i.parent().width()},this.settings.timer,"linear")}.bind(this),this.settings.tipAnimationFadeSpeed)):this.settings.$next_tip.show()):/fade/i.test(this.settings.tipAnimation)&&(i.width(0),this.settings.timer>0?(this.settings.$next_tip.fadeIn(this.settings.tipAnimationFadeSpeed).show(),this.delay(function(){i.animate({width:i.parent().width()},this.settings.timer,"linear")}.bind(this),this.settings.tipAnimationFadeSpeed)):this.settings.$next_tip.fadeIn(this.settings.tipAnimationFadeSpeed)),this.settings.$current_tip=this.settings.$next_tip):this.settings.$li&&this.settings.$target.length<1?this.show():this.end()):this.settings.paused=!0},is_phone:function(){return Modernizr?Modernizr.mq("only screen and (max-width: 767px)")||n(".lt-ie9").length>0:this.settings.$window.width()<767},hide:function(){this.settings.modal&&this.settings.expose&&this.un_expose(),this.settings.modal||n(".joyride-modal-bg").hide(),this.settings.$current_tip.hide(),this.settings.postStepCallback(this.settings.$li.index(),this.settings.$current_tip)},set_li:function(n){n?(this.settings.$li=this.settings.$tip_content.eq(this.settings.startOffset),this.set_next_tip(),this.settings.$current_tip=this.settings.$next_tip):(this.settings.$li=this.settings.$li.next(),this.set_next_tip()),this.set_target()},set_next_tip:function(){this.settings.$next_tip=n(".joyride-tip-guide[data-index='"+this.settings.$li.index()+"']"),this.settings.$next_tip.data("closed","")},set_target:function(){var t=this.settings.$li.attr("data-class"),r=this.settings.$li.attr("data-id"),u=function(){return r?n(i.getElementById(r)):t?n("."+t).first():n("body")};this.settings.$target=u()},scroll_to:function(){var r,i;r=n(t).height()/2,i=Math.ceil(this.settings.$target.offset().top-r+this.outerHeight(this.settings.$next_tip)),i>0&&this.scrollTo(n("html, body"),i,this.settings.scrollSpeed)},paused:function(){return n.inArray(this.settings.$li.index()+1,this.settings.pauseAfter)===-1},restart:function(){this.hide(),this.settings.$li=r,this.show("init")},pos_default:function(i,r){var h=Math.ceil(n(t).height()/2),c=this.settings.$next_tip.offset(),f=this.settings.$next_tip.find(".joyride-nub"),e=Math.ceil(this.outerWidth(f)/2),o=Math.ceil(this.outerHeight(f)/2),s=i||!1,u;s&&(this.settings.$next_tip.css("visibility","hidden"),this.settings.$next_tip.show()),typeof r=="undefined"&&(r=!1),/body/i.test(this.settings.$target.selector)?this.settings.$li.length&&this.pos_modal(f):(this.bottom()?(u=this.settings.$target.offset().left,Foundation.rtl&&(u=this.settings.$target.offset().width-this.settings.$next_tip.width()+u),this.settings.$next_tip.css({top:this.settings.$target.offset().top+o+this.outerHeight(this.settings.$target),left:u}),this.nub_position(f,this.settings.tipSettings.nubPosition,"top")):this.top()?(u=this.settings.$target.offset().left,Foundation.rtl&&(u=this.settings.$target.offset().width-this.settings.$next_tip.width()+u),this.settings.$next_tip.css({top:this.settings.$target.offset().top-this.outerHeight(this.settings.$next_tip)-o,left:u}),this.nub_position(f,this.settings.tipSettings.nubPosition,"bottom")):this.right()?(this.settings.$next_tip.css({top:this.settings.$target.offset().top,left:this.outerWidth(this.settings.$target)+this.settings.$target.offset().left+e}),this.nub_position(f,this.settings.tipSettings.nubPosition,"left")):this.left()&&(this.settings.$next_tip.css({top:this.settings.$target.offset().top,left:this.settings.$target.offset().left-this.outerWidth(this.settings.$next_tip)-e}),this.nub_position(f,this.settings.tipSettings.nubPosition,"right")),!this.visible(this.corners(this.settings.$next_tip))&&this.settings.attempts<this.settings.tipSettings.tipLocationPattern.length&&(f.removeClass("bottom").removeClass("top").removeClass("right").removeClass("left"),this.settings.tipSettings.tipLocation=this.settings.tipSettings.tipLocationPattern[this.settings.attempts],this.settings.attempts++,this.pos_default())),s&&(this.settings.$next_tip.hide(),this.settings.$next_tip.css("visibility","visible"))},pos_phone:function(t){var f=this.outerHeight(this.settings.$next_tip),o=this.settings.$next_tip.offset(),e=this.outerHeight(this.settings.$target),i=n(".joyride-nub",this.settings.$next_tip),r=Math.ceil(this.outerHeight(i)/2),u=t||!1;i.removeClass("bottom").removeClass("top").removeClass("right").removeClass("left"),u&&(this.settings.$next_tip.css("visibility","hidden"),this.settings.$next_tip.show()),/body/i.test(this.settings.$target.selector)?this.settings.$li.length&&this.pos_modal(i):this.top()?(this.settings.$next_tip.offset({top:this.settings.$target.offset().top-f-r}),i.addClass("bottom")):(this.settings.$next_tip.offset({top:this.settings.$target.offset().top+e+r}),i.addClass("top")),u&&(this.settings.$next_tip.hide(),this.settings.$next_tip.css("visibility","visible"))},pos_modal:function(n){this.center(),n.hide(),this.show_modal()},show_modal:function(){if(!this.settings.$next_tip.data("closed")){var t=n(".joyride-modal-bg");t.length<1&&n("body").append(this.settings.template.modal).show(),/pop/i.test(this.settings.tipAnimation)?t.show():t.fadeIn(this.settings.tipAnimationFadeSpeed)}},expose:function(){var r,u,i,f,e="expose-"+Math.floor(Math.random()*1e4);if(arguments.length>0&&arguments[0]instanceof n)i=arguments[0];else if(this.settings.$target&&!/body/i.test(this.settings.$target.selector))i=this.settings.$target;else return!1;if(i.length<1)return t.console&&console.error("element not valid",i),!1;r=n(this.settings.template.expose),this.settings.$body.append(r),r.css({top:i.offset().top,left:i.offset().left,width:this.outerWidth(i,!0),height:this.outerHeight(i,!0)}),u=n(this.settings.template.exposeCover),f={zIndex:i.css("z-index"),position:i.css("position")},i.css("z-index",parseInt(r.css("z-index"))+1),f.position=="static"&&i.css("position","relative"),i.data("expose-css",f),u.css({top:i.offset().top,left:i.offset().left,width:this.outerWidth(i,!0),height:this.outerHeight(i,!0)}),this.settings.$body.append(u),r.addClass(e),u.addClass(e),i.data("expose",e),this.settings.postExposeCallback(this.settings.$li.index(),this.settings.$next_tip,i),this.add_exposed(i)},un_expose:function(){var u,i,f,r,e=!1;if(arguments.length>0&&arguments[0]instanceof n)i=arguments[0];else if(this.settings.$target&&!/body/i.test(this.settings.$target.selector))i=this.settings.$target;else return!1;if(i.length<1)return t.console&&console.error("element not valid",i),!1;u=i.data("expose"),f=n("."+u),arguments.length>1&&(e=arguments[1]),e===!0?n(".joyride-expose-wrapper,.joyride-expose-cover").remove():f.remove(),r=i.data("expose-css"),r.zIndex=="auto"?i.css("z-index",""):i.css("z-index",r.zIndex),r.position!=i.css("position")&&(r.position=="static"?i.css("position",""):i.css("position",r.position)),i.removeData("expose"),i.removeData("expose-z-index"),this.remove_exposed(i)},add_exposed:function(t){this.settings.exposed=this.settings.exposed||[],t instanceof n||typeof t=="object"?this.settings.exposed.push(t[0]):typeof t=="string"&&this.settings.exposed.push(t)},remove_exposed:function(t){var r,u,i;for(t instanceof n?r=t[0]:typeof t=="string"&&(r=t),this.settings.exposed=this.settings.exposed||[],u=this.settings.exposed.length,i=0;i<u;i++)if(this.settings.exposed[i]==r){this.settings.exposed.splice(i,1);return}},center:function(){var i=n(t);return this.settings.$next_tip.css({top:(i.height()-this.outerHeight(this.settings.$next_tip))/2+i.scrollTop(),left:(i.width()-this.outerWidth(this.settings.$next_tip))/2+this.scrollLeft(i)}),!0},bottom:function(){return/bottom/i.test(this.settings.tipSettings.tipLocation)},top:function(){return/top/i.test(this.settings.tipSettings.tipLocation)},right:function(){return/right/i.test(this.settings.tipSettings.tipLocation)},left:function(){return/left/i.test(this.settings.tipSettings.tipLocation)},corners:function(i){var r=n(t),s=r.height()/2,u=Math.ceil(this.settings.$target.offset().top-s+this.settings.$next_tip.outerHeight()),h=r.width()+this.scrollLeft(r),o=r.height()+u,f=r.height()+r.scrollTop(),e=r.scrollTop();return u<e&&(e=u<0?0:u),o>f&&(f=o),[i.offset().top<e,h<i.offset().left+i.outerWidth(),f<i.offset().top+i.outerHeight(),this.scrollLeft(r)>i.offset().left]},visible:function(n){for(var t=n.length;t--;)if(n[t])return!1;return!0},nub_position:function(n,t,i){t==="auto"?n.addClass(i):n.addClass(t)},startTimer:function(){this.settings.$li.length?this.settings.automate=setTimeout(function(){this.hide(),this.show(),this.startTimer()}.bind(this),this.settings.timer):clearTimeout(this.settings.automate)},end:function(){this.settings.cookieMonster&&n.cookie(this.settings.cookieName,"ridden",{expires:this.settings.cookieExpires,domain:this.settings.cookieDomain}),this.settings.timer>0&&clearTimeout(this.settings.automate),this.settings.modal&&this.settings.expose&&this.un_expose(),this.settings.$next_tip.data("closed",!0),n(".joyride-modal-bg").hide(),this.settings.$current_tip.hide(),this.settings.postStepCallback(this.settings.$li.index(),this.settings.$current_tip),this.settings.postRideCallback(this.settings.$li.index(),this.settings.$current_tip),n(".joyride-tip-guide").remove()},outerHTML:function(n){return n.outerHTML||(new XMLSerializer).serializeToString(n)},off:function(){n(this.scope).off(".joyride"),n(t).off(".joyride"),n(".joyride-close-tip, .joyride-next-tip, .joyride-modal-bg").off(".joyride"),n(".joyride-tip-guide, .joyride-modal-bg").remove(),clearTimeout(this.settings.automate),this.settings={}}}})(Foundation.zj,this,this.document);