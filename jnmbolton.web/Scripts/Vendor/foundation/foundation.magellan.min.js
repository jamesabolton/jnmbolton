(function(n,t){"use strict";Foundation.libs.magellan={name:"magellan",version:"4.0.0",settings:{activeClass:"active"},init:function(t,i,r){return this.scope=t||this.scope,Foundation.inherit(this,"data_options"),typeof i=="object"&&n.extend(!0,this.settings,i),typeof i!="string"?(this.settings.init||(this.fixed_magellan=n("[data-magellan-expedition]"),this.set_threshold(),this.last_destination=n("[data-magellan-destination]").last(),this.events()),this.settings.init):this[i].call(this,r)},events:function(){var i=this;n(this.scope).on("arrival.fndtn.magellan","[data-magellan-arrival]",function(){var t=n(this),u=t.closest("[data-magellan-expedition]"),r=u.attr("data-magellan-active-class")||i.settings.activeClass;t.closest("[data-magellan-expedition]").find("[data-magellan-arrival]").not(t).removeClass(r),t.addClass(r)});this.fixed_magellan.on("update-position.fndtn.magellan",function(){var t=n(this)}).trigger("update-position");n(t).on("resize.fndtn.magellan",function(){this.fixed_magellan.trigger("update-position")}.bind(this)).on("scroll.fndtn.magellan",function(){var r=n(t).scrollTop();i.fixed_magellan.each(function(){var t=n(this),u,f;typeof t.data("magellan-top-offset")=="undefined"&&t.data("magellan-top-offset",t.offset().top),typeof t.data("magellan-fixed-position")=="undefined"&&t.data("magellan-fixed-position",!1),u=r+i.settings.threshold>t.data("magellan-top-offset"),f=t.attr("data-magellan-top-offset"),t.data("magellan-fixed-position")!=u&&(t.data("magellan-fixed-position",u),u?t.css({position:"fixed",top:0}):t.css({position:"",top:""}),u&&typeof f!="undefined"&&f!=!1&&t.css({position:"fixed",top:f+"px"}))})});if(this.last_destination.length>0)n(t).on("scroll.fndtn.magellan",function(){var r=n(t).scrollTop(),u=r+n(t).height(),f=Math.ceil(i.last_destination.offset().top);n("[data-magellan-destination]").each(function(){var t=n(this),e=t.attr("data-magellan-destination"),o=t.offset().top-r;o<=i.settings.threshold&&n("[data-magellan-arrival='"+e+"']").trigger("arrival"),u>=n(i.scope).height()&&f>r&&f<u&&n("[data-magellan-arrival]").last().trigger("arrival")})});this.settings.init=!0},set_threshold:function(){this.settings.threshold||(this.settings.threshold=this.fixed_magellan.length>0?this.outerHeight(this.fixed_magellan,!0):0)},off:function(){n(this.scope).off(".fndtn.magellan")}}})(Foundation.zj,this,this.document);